<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paradise Hotel - Admin Dashboard</title>
    <script src="https://kit.fontawesome.com/a2d9d5bd8b.js" crossorigin="anonymous"></script>
    <style>
         :root {
            --primary-color: #2e8b57;
            --secondary-color: #e0f7fa;
            --accent-color: #26a69a;
            --text-color: #355c7d;
            --light-color: #ffffff;
            --dark-bg: #1a1a2e;
            --dark-card: #16213e;
            --dark-text: #e6e6e6;
            --dark-hover: #0f3460;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            display: flex;
            background-color: #f5f5f5;
            color: var(--text-color);
            transition: all 0.3s ease;
        }
        
        body.dark-mode {
            background-color: var(--dark-bg);
            color: var(--dark-text);
        }
        /* Sidebar Styles */
        
        .sidebar {
            width: 250px;
            height: 100vh;
            background: var(--light-color);
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            position: fixed;
            padding: 20px 0;
            transition: all 0.3s ease;
        }
        
        body.dark-mode .sidebar {
            background-color: var(--dark-card);
            box-shadow: 2px 0 10px rgba(26, 252, 142, 0.3);
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 20px 20px;
            border-bottom: 1px solid #eee;
            margin-bottom: 20px;
        }
        
        body.dark-mode .logo-container {
            border-bottom: 1px solid #333;
        }
        
        .logo-icon {
            font-size: 2rem;
            color: var(--primary-color);
            margin-right: 10px;
        }
        
        .logo-text {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            font-family: 'Playfair Display', serif;
        }
        
        .menu-item {
            padding: 15px 25px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-color);
            text-decoration: none;
        }
        
        body.dark-mode .menu-item {
            color: var(--dark-text);
        }
        
        .menu-item:hover {
            background-color: var(--secondary-color);
            color: var(--primary-color);
        }
        
        body.dark-mode .menu-item:hover {
            background-color: var(--dark-hover);
        }
        
        .menu-item.active {
            background-color: var(--secondary-color);
            color: var(--primary-color);
            border-left: 4px solid var(--primary-color);
        }
        
        body.dark-mode .menu-item.active {
            background-color: var(--dark-hover);
        }
        
        .menu-item i {
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .sub-menu {
            padding-left: 40px;
            display: none;
        }
        
        .sub-menu.show {
            display: block;
        }
        
        .sub-menu-item {
            padding: 10px 15px;
            display: block;
            color: var(--text-color);
            text-decoration: none;
            transition: all 0.3s ease;
        }
        
        body.dark-mode .sub-menu-item {
            color: var(--dark-text);
        }
        
        .sub-menu-item:hover {
            color: var(--primary-color);
            background-color: rgba(46, 139, 87, 0.1);
        }
        
        body.dark-mode .sub-menu-item:hover {
            background-color: var(--dark-hover);
        }
        /* Main Content Styles */
        
        .main-content {
            margin-left: 250px;
            width: calc(100% - 250px);
            padding: 20px;
            background-color: #f9f9f9;
            min-height: 100vh;
            transition: all 0.3s ease;
        }
        
        body.dark-mode .main-content {
            background-color: var(--dark-bg);
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background-color: var(--light-color);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        body.dark-mode .header {
            background-color: var(--dark-card);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        
        .user-info img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
        }
        /* Dashboard Content Styles */
        
        .dashboard-title {
            font-size: 1.8rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            font-family: 'Playfair Display', serif;
        }
        
        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: var(--light-color);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.3s ease;
        }
        
        body.dark-mode .card {
            background-color: var(--dark-card);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card i {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .card h3 {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: var(--text-color);
        }
        
        body.dark-mode .card h3 {
            color: var(--dark-text);
        }
        
        .card p {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        /* Section Styles */
        
        .section {
            background: var(--light-color);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        body.dark-mode .section {
            background-color: var(--dark-card);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        
        .section-title {
            font-size: 1.3rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        body.dark-mode .section-title {
            border-bottom: 1px solid #333;
        }
        /* Table Styles */
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        th,
        td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        body.dark-mode th,
        body.dark-mode td {
            border-bottom: 1px solid #333;
            color: var(--dark-text);
        }
        
        th {
            background-color: var(--secondary-color);
            color: var(--primary-color);
            font-weight: 600;
        }
        
        body.dark-mode th {
            background-color: var(--dark-hover);
        }
        
        tr:hover {
            background-color: rgba(224, 247, 250, 0.5);
        }
        
        body.dark-mode tr:hover {
            background-color: var(--dark-hover);
        }
        /* Status badges */
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: capitalize;
        }
        
        .status-pending {
            background-color: #FFF3CD;
            color: #856404;
        }
        
        body.dark-mode .status-pending {
            background-color: #856404;
            color: #FFF3CD;
        }
        
        .status-approved {
            background-color: #D4EDDA;
            color: #155724;
        }
        
        body.dark-mode .status-approved {
            background-color: #155724;
            color: #D4EDDA;
        }
        
        .status-declined {
            background-color: #F8D7DA;
            color: #721C24;
        }
        
        body.dark-mode .status-declined {
            background-color: #721C24;
            color: #F8D7DA;
        }
        
        .status-reported {
            background-color: #E2E3E5;
            color: #383D41;
        }
        
        body.dark-mode .status-reported {
            background-color: #383D41;
            color: #E2E3E5;
        }
        /* Action buttons */
        
        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 500;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .action-btn i {
            font-size: 0.9rem;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #247a4a;
        }
        
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #5a6268;
        }
        
        .btn-danger {
            background-color: #dc3545;
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c82333;
        }
        /* Action select styles */
        
        .action-select {
            padding: 5px 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
            background-color: white;
            cursor: pointer;
            margin-right: 8px;
        }
        
        body.dark-mode .action-select {
            background-color: #333;
            color: white;
            border-color: #555;
        }
        
        .action-select.approved {
            background-color: #e6f7ee;
            border-color: #2e8b57;
        }
        
        .action-select.declined {
            background-color: #fde8e8;
            border-color: #ef4444;
        }
        /* Header buttons */
        
        .header-buttons {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .dark-mode-toggle,
        .burger-menu {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: var(--text-color);
            transition: all 0.3s ease;
        }
        
        body.dark-mode .dark-mode-toggle,
        body.dark-mode .burger-menu {
            color: var(--dark-text);
        }
        
        .dark-mode-toggle:hover,
        .burger-menu:hover {
            color: var(--primary-color);
            transform: scale(1.1);
        }
        /* User Dropdown Styles */
        
        .user-dropdown {
            position: relative;
            display: inline-block;
        }
        
        .user-dropdown-content {
            display: none;
            position: absolute;
            right: 0;
            background-color: #f9f9f9;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
            z-index: 1;
            border-radius: 4px;
        }
        
        body.dark-mode .user-dropdown-content {
            background-color: #333;
            color: white;
        }
        
        .user-dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }
        
        body.dark-mode .user-dropdown-content a {
            color: white;
        }
        
        .user-dropdown-content a:hover {
            background-color: #ddd;
        }
        
        body.dark-mode .user-dropdown-content a:hover {
            background-color: #555;
        }
        
        .user-dropdown:hover .user-dropdown-content {
            display: block;
        }
        
        .user-info {
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
        }
        /* Responsive Styles */
        
        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
            }
            .sidebar .logo-text,
            .sidebar .menu-item span {
                display: none;
            }
            .sidebar .menu-item {
                justify-content: center;
            }
            .sidebar .menu-item i {
                margin-right: 0;
                font-size: 1.5rem;
            }
            .main-content {
                margin-left: 70px;
                width: calc(100% - 70px);
            }
            .header h2 {
                font-size: 1.2rem;
            }
            .logo-text {
                display: none;
            }
            .burger-menu {
                display: block;
            }
        }
        
        @media (min-width: 769px) {
            .burger-menu {
                display: none;
            }
        }
    </style>
</head>

<body>
    <!-- Sidebar Navigation -->
    <div class="sidebar">
        <div class="logo-container">
            <i class="fas fa-umbrella-beach logo-icon"></i>
            <span class="logo-text">PARADISE HOTEL</span>
        </div>

        <a href="dashboard.html" class="menu-item active">
            <i class="fas fa-tachometer-alt"></i>
            <span>Dashboard</span>
        </a>

        <div class="menu-item">
            <i class="fas fa-chart-pie"></i>
            <span>Data Insight</span>
            <i class="fas fa-chevron-down" style="margin-left: auto;"></i>
        </div>
        <div class="sub-menu">
            <a href="data_insight.html" class="sub-menu-item">Analytics</a>
        </div>

        <a href="employee.html" class="menu-item">
            <i class="fas fa-users"></i>
            <span>Employee & Shift Management</span>
        </a>

        <a href="leave.html" class="menu-item">
            <i class="fas fa-calendar-check"></i>
            <span>Leave Management</span>
        </a>

        <a href="violation.html" class="menu-item">
            <i class="fas fa-exclamation-triangle"></i>
            <span>Employee Violation</span>
        </a>
    </div>

    <!-- Main Content Area -->
    <div class="main-content">
        <div class="header">
            <div style="display: flex; align-items: center; gap: 15px;">
                <button class="burger-menu" onclick="toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </button>
                <h2>Admin Dashboard</h2>
            </div>
            <div class="header-buttons">
                <button class="dark-mode-toggle" onclick="toggleDarkMode()">
                    <i class="fas fa-moon"></i>
                    <span class="dark-mode-text">Dark Mode</span>
                </button>
                <div class="user-dropdown">
                    <div class="user-info" onclick="toggleUserDropdown()">
                        <img src="https://via.placeholder.com/40" alt="User" class="user-avatar">
                        <span>Admin User</span>
                        <i class="fas fa-caret-down"></i>
                    </div>
                    <div class="user-dropdown-content" id="userDropdown">
                        <a href="#" onclick="signOut()"><i class="fas fa-sign-out-alt"></i> Sign Out</a>
                    </div>
                </div>
            </div>
        </div>

        <h1 class="dashboard-title">Welcome to Paradise Hotel Management</h1>

        <!-- Summary Cards -->
        <div class="card-container">
            <div class="card">
                <i class="fas fa-users"></i>
                <h3>Total Employees</h3>
                <p>142</p>
            </div>
            <div class="card">
                <i class="fas fa-calendar-check"></i>
                <h3>Active Shifts</h3>
                <p>8</p>
            </div>
            <div class="card">
                <i class="fas fa-clock"></i>
                <h3>Pending Requests</h3>
                <p>12</p>
            </div>
            <div class="card">
                <i class="fas fa-exclamation"></i>
                <h3>Violations</h3>
                <p>5</p>
            </div>
        </div>

        <!-- Recent Activities Section - Fixed -->
        <div class="section">
            <h3 class="section-title">Recent Activities</h3>
            <table>
                <thead>
                    <tr>
                        <th>Employee</th>
                        <th>Activity</th>
                        <th>Department</th>
                        <th>Time</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="recentActivitiesTable">
                    <!-- Will be filled by JavaScript -->
                </tbody>
            </table>
        </div>

        <!-- Recent Leave Requests (unchanged) -->
        <div class="section">
            <h3 class="section-title">Recent Leave Requests</h3>
            <table>
                <thead>
                    <tr>
                        <th>Employee ID</th>
                        <th>Start Date</th>
                        <th>End Date</th>
                        <th>Status</th>
                        <th>Action</th>
                        <th>Reason</th>
                        <th>Date Submitted</th>
                    </tr>
                </thead>
                <tbody id="leaveRequestsTable">
                    <!-- Filled by JS -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Toggle sidebar
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const mainContent = document.querySelector('.main-content');

            if (sidebar.style.width === '70px') {
                sidebar.style.width = '250px';
                mainContent.style.marginLeft = '250px';
                mainContent.style.width = 'calc(100% - 250px)';

                // Show menu item text
                document.querySelectorAll('.menu-item span').forEach(el => {
                    el.style.display = 'inline';
                });

                // Show logo text
                document.querySelector('.logo-text').style.display = 'inline';
            } else {
                sidebar.style.width = '70px';
                mainContent.style.marginLeft = '70px';
                mainContent.style.width = 'calc(100% - 70px)';

                // Hide menu item text
                document.querySelectorAll('.menu-item span').forEach(el => {
                    el.style.display = 'none';
                });

                // Hide logo text
                document.querySelector('.logo-text').style.display = 'none';
            }
        }

        // Toggle dark mode
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');

            // Save preference to localStorage
            const isDarkMode = document.body.classList.contains('dark-mode');
            localStorage.setItem('darkMode', isDarkMode);

            // Update icon and text
            const darkModeToggle = document.querySelector('.dark-mode-toggle');
            const darkModeText = document.querySelector('.dark-mode-text');

            if (isDarkMode) {
                darkModeToggle.innerHTML = '<i class="fas fa-sun"></i> <span class="dark-mode-text">Light Mode</span>';
            } else {
                darkModeToggle.innerHTML = '<i class="fas fa-moon"></i> <span class="dark-mode-text">Dark Mode</span>';
            }
        }

        // Check for saved dark mode preference
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.classList.add('dark-mode');
            document.querySelector('.dark-mode-toggle').innerHTML = '<i class="fas fa-sun"></i> <span class="dark-mode-text">Light Mode</span>';
        }

        // Toggle user dropdown
        function toggleUserDropdown() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
        }

        // Close dropdown when clicking outside
        window.onclick = function(event) {
            if (!event.target.matches('.user-info') && !event.target.closest('.user-info')) {
                const dropdowns = document.getElementsByClassName("user-dropdown-content");
                for (let i = 0; i < dropdowns.length; i++) {
                    const openDropdown = dropdowns[i];
                    if (openDropdown.style.display === 'block') {
                        openDropdown.style.display = 'none';
                    }
                }
            }
        }

        // Sign out function
        function signOut() {
            // Add your sign out logic here
            alert('Signing out...');
            // window.location.href = 'login.html'; // Redirect to login page
        }

        // Toggle submenus
        function toggleSubMenu(menu) {
            const submenu = document.getElementById(`${menu}-submenu`);
            submenu.classList.toggle('show');

            const menuItem = submenu.previousElementSibling;
            const chevron = menuItem.querySelector('.fa-chevron-down');
            chevron.classList.toggle('rotate-180');
        }

        // Sample data for Recent Activities
        const recentActivities = [{
            employee: "John Smith",
            activity: "Leave Request",
            department: "Housekeeping",
            time: "10:30 AM",
            status: "Pending",
            email: "john.smith@paradisehotel.com"
        }, {
            employee: "Sarah Johnson",
            activity: "Shift Change",
            department: "Front Desk",
            time: "9:15 AM",
            status: "Approved",
            email: "sarah.johnson@paradisehotel.com"
        }, {
            employee: "Michael Brown",
            activity: "Late Arrival",
            department: "Maintenance",
            time: "8:45 AM",
            status: "Reported",
            email: "michael.brown@paradisehotel.com"
        }, {
            employee: "Emily Davis",
            activity: "Overtime Request",
            department: "Food & Beverage",
            time: "Yesterday",
            status: "Pending",
            email: "emily.davis@paradisehotel.com"
        }];

        // Sample data for Leave Requests
        const recentLeaveRequests = [{
            employee_id: "E001",
            name: "John Smith",
            start_date: "2025-04-01",
            end_date: "2025-04-05",
            status: "Pending",
            remarks: "Family Trip",
            date_submitted: "2025-03-25",
            email: "john.smith@paradisehotel.com"
        }, {
            employee_id: "E007",
            name: "Sarah Johnson",
            start_date: "2025-04-10",
            end_date: "2025-04-12",
            status: "Pending",
            remarks: "Medical",
            date_submitted: "2025-04-01",
            email: "sarah.johnson@paradisehotel.com"
        }, {
            employee_id: "E023",
            name: "Michael Brown",
            start_date: "2025-04-15",
            end_date: "2025-04-16",
            status: "Pending",
            remarks: "Personal",
            date_submitted: "2025-04-03",
            email: "michael.brown@paradisehotel.com"
        }];

        // Function to send email notification for activities
        function sendActivityNotification(employeeName, employeeEmail, activity, status) {
            if (status === 'Pending') {
                alert('Please select Approve or Decline before sending notification');
                return;
            }

            const subject = encodeURIComponent(`${activity} - ${status}`);
            const body = encodeURIComponent(
                `Dear ${employeeName},\n\n` +
                `Your ${activity.toLowerCase()} has been ${status.toLowerCase()}.\n\n` +
                `Best regards,\n` +
                `Paradise Hotel Management`
            );

            window.open(
                `https://mail.google.com/mail/?view=cm&fs=1&to=${employeeEmail}&su=${subject}&body=${body}`,
                '_blank'
            );
        }

        // Handle activity action selection
        function handleActivityAction(selectElement, employeeName) {
            const action = selectElement.value;
            const row = selectElement.closest('tr');
            const statusCell = row.querySelector('.status-cell');

            // Reset all classes
            selectElement.classList.remove('approved', 'declined');

            if (action === 'approve' || action === 'decline') {
                const status = action === 'approve' ? 'Approved' : 'Declined';
                statusCell.textContent = status;

                // Find or create the notify button
                let notifyBtn = row.querySelector('.notify-btn');
                if (!notifyBtn) {
                    notifyBtn = document.createElement('button');
                    notifyBtn.className = 'notify-btn';
                    notifyBtn.innerHTML = '<i class="fas fa-envelope"></i> Notify';
                    selectElement.parentNode.appendChild(notifyBtn);
                }

                // Get activity details
                const activity = row.cells[1].textContent;
                const email = recentActivities.find(a => a.employee === employeeName) ?.email || `${employeeName.toLowerCase().replace(' ', '.')}@paradisehotel.com`;

                notifyBtn.onclick = function() {
                    sendActivityNotification(
                        employeeName,
                        email,
                        activity,
                        status
                    );
                };


                selectElement.classList.add(action === 'approve' ? 'approved' : 'declined');
                alert(`Activity for ${employeeName} has been ${status.toLowerCase()}. Click "Notify" to send email.`);
            }

            console.log(`Activity action for ${employeeName}: ${action}`);
        }

        // Function to populate the recent activities table
        function populateRecentActivitiesTable() {
            const activitiesTable = document.getElementById('recentActivitiesTable');
            if (activitiesTable) {
                activitiesTable.innerHTML = ''; // Clear existing rows

                recentActivities.forEach(activity => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${activity.employee}</td>
                        <td>${activity.activity}</td>
                        <td>${activity.department}</td>
                        <td>${activity.time}</td>
                        <td class="status-cell">${activity.status}</td>
                        <td>
                            <select class="action-select" onchange="handleActivityAction(this, '${activity.employee}')">
                                <option value="">Select Action</option>
                                <option value="approve">Approve</option>
                                <option value="decline">Decline</option>
                            </select>
                        </td>
                    `;
                    activitiesTable.appendChild(row);
                });
            }
        }

        // Function to send email notification for leave requests
        function sendLeaveNotification(employeeId, employeeName, employeeEmail, status) {
            if (status === 'Pending') {
                alert('Please select Approve or Decline before sending notification');
                return;
            }

            const subject = encodeURIComponent(`Leave Request ${status}`);
            const body = encodeURIComponent(
                `Dear ${employeeName},\n\n` +
                `Your leave request has been ${status.toLowerCase()}.\n\n` +
                `Best regards,\n` +
                `Paradise Hotel Management`
            );

            window.open(
                `https://mail.google.com/mail/?view=cm&fs=1&to=${employeeEmail}&su=${subject}&body=${body}`,
                '_blank'
            );
        }

        // Handle leave action selection
        function handleLeaveAction(selectElement, employeeId) {
            const action = selectElement.value;
            const row = selectElement.closest('tr');
            const statusCell = row.querySelector('.status-cell');

            // Reset all classes
            selectElement.classList.remove('approved', 'declined');

            if (action === 'approve' || action === 'decline') {
                const status = action === 'approve' ? 'Approved' : 'Declined';
                statusCell.textContent = status;

                // Find or create the notify button
                let notifyBtn = row.querySelector('.notify-btn');
                if (!notifyBtn) {
                    notifyBtn = document.createElement('button');
                    notifyBtn.className = 'notify-btn';
                    notifyBtn.innerHTML = '<i class="fas fa-envelope"></i> Notify';
                    selectElement.parentNode.appendChild(notifyBtn);
                }

                // Get employee details from data
                const request = recentLeaveRequests.find(req => req.employee_id === employeeId);

                notifyBtn.onclick = function() {
                    sendLeaveNotification(
                        employeeId,
                        request.name,
                        request.email,
                        status
                    );
                };

                selectElement.classList.add(action === 'approve' ? 'approved' : 'declined');
                alert(`Leave request for ${employeeId} has been ${status.toLowerCase()}. Click "Notify" to send email.`);
            }

            console.log(`Leave request action for ${employeeId}: ${action}`);
        }

        // Function to populate the leave requests table
        function populateLeaveRequestsTable() {
            const leaveRequestsTable = document.getElementById('leaveRequestsTable');
            if (leaveRequestsTable) {
                leaveRequestsTable.innerHTML = ''; // Clear existing rows

                recentLeaveRequests.forEach(request => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${request.employee_id}</td>
                        <td>${request.start_date}</td>
                        <td>${request.end_date}</td>
                        <td class="status-cell">${request.status}</td>
                        <td>
                            <select class="action-select" onchange="handleLeaveAction(this, '${request.employee_id}')">
                                <option value="">Select Action</option>
                                <option value="approve">Approve</option>
                                <option value="decline">Decline</option>
                            </select>
                        </td>
                        <td>${request.remarks}</td>
                        <td>${request.date_submitted}</td>
                    `;
                    leaveRequestsTable.appendChild(row);
                });
            }
        }

        // Wait for DOM to be fully loaded before populating the tables
        document.addEventListener('DOMContentLoaded', function() {
            populateRecentActivitiesTable();
            populateLeaveRequestsTable();
        });
    </script>
</body>

</html>
